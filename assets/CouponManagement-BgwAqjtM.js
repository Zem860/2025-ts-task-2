import{a as b,d as m,r as c,o as v,e as d,f as i,g as e,F as y,n as f,t as o,p as C}from"./index-iTxgF18V.js";const k="https://vue3-course-api.hexschool.io",h="buch",r=b.create({baseURL:k});r.interceptors.request.use(s=>{const a=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");return a&&(s.headers.Authorization=a),s});r.interceptors.response.use(s=>Promise.resolve(s),s=>Promise.reject(s.response.data));const $=s=>r.get(`/v2/api/${h}/admin/coupons`,{params:s}),x=s=>r.delete(`/v2/api/${h}/admin/coupon/${s}`),A={class:"card shadow-sm rounded-lg"},P={class:"card-body p-4"},w={class:"table table-hover"},B=["onClick"],z=m({__name:"CouponManagement",setup(s){const a=c([]),g=c({total_pages:0,current_page:0,has_pre:!1,has_next:!1,category:""}),u=c("1"),p=async(l="1")=>{try{const t=await $({page:l});console.log("API 回應:",t.data),a.value=t.data.coupons,g.value=t.data.pagination}catch(t){console.error("取得優惠券失敗:",t)}},_=async l=>{try{await x(l),p(u.value)}catch(t){console.error("刪除優惠券失敗:",t)}};return v(async()=>{await p(u.value)}),(l,t)=>(i(),d("div",A,[e("div",P,[t[1]||(t[1]=e("h4",{class:"mb-4"},"優惠券管理",-1)),e("table",w,[t[0]||(t[0]=e("thead",null,[e("tr",null,[e("th",null,"優惠券代碼"),e("th",null,"優惠券名稱"),e("th",null,"折扣"),e("th",null,"到期日期"),e("th",null,"啟用狀態"),e("th",null,"操作")])],-1)),e("tbody",null,[(i(!0),d(y,null,f(a.value,n=>(i(),d("tr",{key:n.id},[e("td",null,o(n.code),1),e("td",null,o(n.title),1),e("td",null,o(n.percent)+"%",1),e("td",null,o(new Date(n.due_date*1e3).toLocaleDateString("zh-TW")),1),e("td",null,[e("span",{class:C({"badge bg-success":n.is_enabled===1,"badge bg-danger":n.is_enabled===0})},o(n.is_enabled===1?"啟用":"停用"),3)]),e("td",null,[e("button",{onClick:D=>_(n.id),class:"btn btn-sm btn-outline-danger rounded-lg"}," 刪除 ",8,B)])]))),128))])])])]))}});export{z as default};
